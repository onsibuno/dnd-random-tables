{% extends 'base.html.twig' %}

{% block title %}Random Dnd Tables{% endblock %}

{% block stylesheets %}
<link rel="stylesheet" href="{{ asset('styles/tables/tables.css') }}">
{% endblock %}

{% block body %}

    <style> 
        #mainView{
            background-image: url("{{asset(lienPage)}}");
        }
    </style>

    <div id="logo"><img src="{{asset('images/Dice.png')}}" alt="illustration de d20"></div>

    <nav> 
        {% if app.user %}
            <div class="mb-3">
                You are logged in as
                {{ app.user.userIdentifier }}, <br>
                <a href="{{ path('app_logout') }}">Logout</a>
            </div>
        {% endif %}
        <ul>
            <li> Tables Génériques :
                <ul>
                    {% for random_table in random_tables %}
                    <li><a href="{{ path('app_dnd_table', {'id': random_table.id}) }}">{{ random_table.TableName }}</a></li>
                    {% endfor %}
                </ul>
            </li>
            <br>
            <li> Mes Tables :
                <ul>
                    {% for random_table in random_tables | filter((random_table) => random_table.DungeonMaster == app.user) %}
                    <li><a href="">{{ random_table.TableName }}</a></li>
                    {% else %}
                        <li>aucune table</li>
                    {% endfor %}
                </ul>
            </li>
        </ul>
        <button type="button" onclick="location.href = 'new/table'"><p>nouvelle <br> table aléatoire</p></button>
    </nav>
    <section id="topView">
        <div>
            <button>roll the dice</button>
            <input type="text" placeholder="input a result">
        </div>
        <img src="{{asset('images/Dice.png')}}" alt="illustration de d20">
    </section>

    <section id="mainView">
        {% set parsedJSON = chosen_table.Content | decode_json %}

        <table class="{{chosen_table.Theme}}">
            <tr>
                    <th>{{chosen_table.Dice}}</th> 
                    <th>{{chosen_table.TableName}}</th>
            </tr>
            {# <pre>{{ dump(parsedJSON) }}</pre> #}
            {% for ligne in parsedJSON[0].table %}
                <tr>
                    <td scope="dice">{{ ligne.case }}</td> 
                    {% if ligne.categorie == "CAT5" %}
                        <td scope="text"><a href="lien api">{{ ligne.choix }}</a></td> 
                    {% else %}
                        <td scope="text">
                            {% if ligne.nombre %}
                                 1d{{ ligne.nombre }}
                            {% endif %}
                             {{ ligne.choix }}</td> 
                    {% endif %}
                    
                </tr> 
            {% endfor %}
        </table>
        {# <p><a href="{{ path('app_random_tables_crud_edit', {'id': chosen_table.id}) }}">edit</a>this table</p> #}
    </section>
{% endblock %}